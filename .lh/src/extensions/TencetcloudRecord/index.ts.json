{
    "sourceFile": "src/extensions/TencetcloudRecord/index.ts",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 22,
            "patches": [
                {
                    "date": 1681712555157,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1681714780389,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,11 +1,11 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 14:22:34\n+ * @LastEditTime: 2023-04-17 14:23:11\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n- * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n+ * @FilePath: /speak-gpt/src/core/TencetcloudRecord/index.ts\n  */\n \n import webRecorder from './SDK/webRecorder'\n import SpeechRecognizer from './SDK/speechRecognizer'\n@@ -76,22 +76,22 @@\n       console.log('开始识别', res);\n       this.isCanSendData = true;\n       this.isCanStop = true;\n     };\n-  \n+    // @ts-ignore \n     this.speechRecognizer!.OnRecognitionResultChange = (res: any) => {\n       console.log('识别变化时', res);\n     };\n-    // 一句话结束\n+    // @ts-ignore 一句话结束\n     this.speechRecognizer!.OnSentenceEnd = (res: any) => {\n       console.log('一句话结束', res);\n     };\n-    // 识别结束\n+    // @ts-ignore 识别结束\n     this.speechRecognizer!.OnRecognitionComplete = (res: any) => {\n       console.log('识别结束', res);\n       this.isCanSendData = false;\n     };\n-    // 识别错误\n+    // @ts-ignore 识别错误\n     this.speechRecognizer!.OnError = (res: any) => {\n       console.log('识别失败', res);\n       this.isCanSendData = false;\n     };\n"
                },
                {
                    "date": 1681716225781,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n  * @LastEditTime: 2023-04-17 14:23:11\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/core/TencetcloudRecord/index.ts\n  */\n-\n+import {InstallExtension} from '@/core/InstallExtension' \n import webRecorder from './SDK/webRecorder'\n import SpeechRecognizer from './SDK/speechRecognizer'\n import { signCallback } from './SDK/asrauthentication'\n \n@@ -39,9 +39,9 @@\n   constructor () {\n \n   }\n \n-  startRecord() {\n+  public startRecord() {\n     this.recorder = new webRecorder()\n     const self = this\n     this.recorder.OnReceivedData = (res) => {\n       console.log(res) // res 为采集到浏览器数据\n@@ -64,9 +64,9 @@\n       this.speechRecognizer!.start();\n     }\n   }\n \n-  stopRecord() {\n+  public stopRecord() {\n     if (this.isCanStop) {\n       this.speechRecognizer!.stop();\n     }\n   }\n@@ -98,5 +98,7 @@\n \n   }\n \n   static extensionName = 'TencetCloudRecord'\n-}\n\\ No newline at end of file\n+}\n+\n+InstallExtension.use(TencetCloudRecord.extensionName, TencetCloudRecord)\n\\ No newline at end of file\n"
                },
                {
                    "date": 1681716948908,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,11 +1,11 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 14:23:11\n+ * @LastEditTime: 2023-04-17 15:35:47\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n- * @FilePath: /speak-gpt/src/core/TencetcloudRecord/index.ts\n+ * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n import {InstallExtension} from '@/core/InstallExtension' \n import webRecorder from './SDK/webRecorder'\n import SpeechRecognizer from './SDK/speechRecognizer'\n"
                },
                {
                    "date": 1681717658693,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,13 +1,13 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 15:35:47\n+ * @LastEditTime: 2023-04-17 15:47:36\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n-import {InstallExtension} from '@/core/InstallExtension' \n+import { InstallExtension } from '@/core/InstallExtension'\n import webRecorder from './SDK/webRecorder'\n import SpeechRecognizer from './SDK/speechRecognizer'\n import { signCallback } from './SDK/asrauthentication'\n \n@@ -35,17 +35,21 @@\n   private recorder: webRecorder | null = null;\n   private speechRecognizer: SpeechRecognizer | null = null;\n   private isCanSendData: boolean = false;\n   private isCanStop: boolean = false;\n-  constructor () {\n+  private  resultText: string = ''\n+  private Parent: InstallExtension | null = null\n \n+\n+  constructor (parent: InstallExtension) {\n+    this.Parent = parent\n   }\n \n   public startRecord() {\n     this.recorder = new webRecorder()\n     const self = this\n     this.recorder.OnReceivedData = (res) => {\n-      console.log(res) // res 为采集到浏览器数据\n+      // res 为采集到浏览器数据\n       if (self.isCanSendData) {\n         // 发送数据\n         self.speechRecognizer!.write(res);\n       }\n@@ -58,9 +62,9 @@\n \n     if (!this.speechRecognizer) {\n       this.speechRecognizer = new SpeechRecognizer(config);\n       this.addListenerCallBack()\n-      \n+\n       // 建立连接\n       this.speechRecognizer!.start();\n     }\n   }\n@@ -79,22 +83,28 @@\n     };\n     // @ts-ignore \n     this.speechRecognizer!.OnRecognitionResultChange = (res: any) => {\n       console.log('识别变化时', res);\n+      const currentText = `${this.resultText}${res.result.voice_text_str}`;\n+      this.Parent?.emit('ResultChange', currentText)\n     };\n     // @ts-ignore 一句话结束\n     this.speechRecognizer!.OnSentenceEnd = (res: any) => {\n       console.log('一句话结束', res);\n+      this.resultText += res.result.voice_text_str;\n+      this.Parent?.emit('SentenceEnd', this.resultText)\n     };\n     // @ts-ignore 识别结束\n     this.speechRecognizer!.OnRecognitionComplete = (res: any) => {\n       console.log('识别结束', res);\n       this.isCanSendData = false;\n+      this.Parent?.emit('RecognitionComplete', res)\n     };\n     // @ts-ignore 识别错误\n     this.speechRecognizer!.OnError = (res: any) => {\n       console.log('识别失败', res);\n       this.isCanSendData = false;\n+      this.Parent?.emit('Error', res)\n     };\n \n   }\n \n"
                },
                {
                    "date": 1681717786117,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 15:47:36\n+ * @LastEditTime: 2023-04-17 15:49:43\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n import { InstallExtension } from '@/core/InstallExtension'\n"
                },
                {
                    "date": 1681717983175,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 15:49:43\n+ * @LastEditTime: 2023-04-17 15:53:01\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n import { InstallExtension } from '@/core/InstallExtension'\n@@ -40,8 +40,9 @@\n   private Parent: InstallExtension | null = null\n \n \n   constructor (parent: InstallExtension) {\n+    console.log('parent', parent)\n     this.Parent = parent\n   }\n \n   public startRecord() {\n"
                },
                {
                    "date": 1681718132351,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 15:53:01\n+ * @LastEditTime: 2023-04-17 15:55:29\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n import { InstallExtension } from '@/core/InstallExtension'\n@@ -85,27 +85,27 @@\n     // @ts-ignore \n     this.speechRecognizer!.OnRecognitionResultChange = (res: any) => {\n       console.log('识别变化时', res);\n       const currentText = `${this.resultText}${res.result.voice_text_str}`;\n-      this.Parent?.emit('ResultChange', currentText)\n+      InstallExtension.emitter.emit('ResultChange', currentText)\n     };\n     // @ts-ignore 一句话结束\n     this.speechRecognizer!.OnSentenceEnd = (res: any) => {\n       console.log('一句话结束', res);\n       this.resultText += res.result.voice_text_str;\n-      this.Parent?.emit('SentenceEnd', this.resultText)\n+      InstallExtension.emitter.emit('SentenceEnd', this.resultText)\n     };\n     // @ts-ignore 识别结束\n     this.speechRecognizer!.OnRecognitionComplete = (res: any) => {\n       console.log('识别结束', res);\n       this.isCanSendData = false;\n-      this.Parent?.emit('RecognitionComplete', res)\n+      InstallExtension.emitter.emit('RecognitionComplete', res)\n     };\n     // @ts-ignore 识别错误\n     this.speechRecognizer!.OnError = (res: any) => {\n       console.log('识别失败', res);\n       this.isCanSendData = false;\n-      this.Parent?.emit('Error', res)\n+      InstallExtension.emitter.emit('Error', res)\n     };\n \n   }\n \n"
                },
                {
                    "date": 1681718144267,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -83,27 +83,23 @@\n       this.isCanStop = true;\n     };\n     // @ts-ignore \n     this.speechRecognizer!.OnRecognitionResultChange = (res: any) => {\n-      console.log('识别变化时', res);\n       const currentText = `${this.resultText}${res.result.voice_text_str}`;\n       InstallExtension.emitter.emit('ResultChange', currentText)\n     };\n     // @ts-ignore 一句话结束\n     this.speechRecognizer!.OnSentenceEnd = (res: any) => {\n-      console.log('一句话结束', res);\n       this.resultText += res.result.voice_text_str;\n       InstallExtension.emitter.emit('SentenceEnd', this.resultText)\n     };\n     // @ts-ignore 识别结束\n     this.speechRecognizer!.OnRecognitionComplete = (res: any) => {\n-      console.log('识别结束', res);\n       this.isCanSendData = false;\n       InstallExtension.emitter.emit('RecognitionComplete', res)\n     };\n     // @ts-ignore 识别错误\n     this.speechRecognizer!.OnError = (res: any) => {\n-      console.log('识别失败', res);\n       this.isCanSendData = false;\n       InstallExtension.emitter.emit('Error', res)\n     };\n \n"
                },
                {
                    "date": 1681718152344,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -93,13 +93,15 @@\n       InstallExtension.emitter.emit('SentenceEnd', this.resultText)\n     };\n     // @ts-ignore 识别结束\n     this.speechRecognizer!.OnRecognitionComplete = (res: any) => {\n+      console.log('识别结束', res);\n       this.isCanSendData = false;\n       InstallExtension.emitter.emit('RecognitionComplete', res)\n     };\n     // @ts-ignore 识别错误\n     this.speechRecognizer!.OnError = (res: any) => {\n+      console.log('识别失败', res);\n       this.isCanSendData = false;\n       InstallExtension.emitter.emit('Error', res)\n     };\n \n"
                },
                {
                    "date": 1681719798640,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 15:55:29\n+ * @LastEditTime: 2023-04-17 16:23:18\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n import { InstallExtension } from '@/core/InstallExtension'\n@@ -40,9 +40,8 @@\n   private Parent: InstallExtension | null = null\n \n \n   constructor (parent: InstallExtension) {\n-    console.log('parent', parent)\n     this.Parent = parent\n   }\n \n   public startRecord() {\n"
                },
                {
                    "date": 1681719825596,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -36,13 +36,11 @@\n   private speechRecognizer: SpeechRecognizer | null = null;\n   private isCanSendData: boolean = false;\n   private isCanStop: boolean = false;\n   private  resultText: string = ''\n-  private Parent: InstallExtension | null = null\n \n \n-  constructor (parent: InstallExtension) {\n-    this.Parent = parent\n+  constructor () {\n   }\n \n   public startRecord() {\n     this.recorder = new webRecorder()\n"
                },
                {
                    "date": 1681723188710,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 16:23:18\n+ * @LastEditTime: 2023-04-17 17:19:47\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n import { InstallExtension } from '@/core/InstallExtension'\n@@ -11,11 +11,11 @@\n import SpeechRecognizer from './SDK/speechRecognizer'\n import { signCallback } from './SDK/asrauthentication'\n \n const config = {\n-  secretKey: 'Ndpvv6EJMKBuYfjjdt25972xqhVCoJnF',\n-  secretid: 'AKIDLeHoDXmuvrjUehfYK2gCf5QfpvtkVAh7',\n-  appid: 1256214321,\n+  secretKey:process.env.secretKey,\n+  secretid: process.env.secretid,\n+  appid: process.env.appid,\n   signCallback: signCallback, // 鉴权函数 用户提供鉴权函数，不传则为null\n   // 用户参数\n   // 实时识别接口参数\n   engine_model_type: '16k_zh', // 引擎\n"
                },
                {
                    "date": 1681723216497,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -10,8 +10,9 @@\n import webRecorder from './SDK/webRecorder'\n import SpeechRecognizer from './SDK/speechRecognizer'\n import { signCallback } from './SDK/asrauthentication'\n \n+console.log('process', process)\n const config = {\n   secretKey:process.env.secretKey,\n   secretid: process.env.secretid,\n   appid: process.env.appid,\n"
                },
                {
                    "date": 1681723359230,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 17:19:47\n+ * @LastEditTime: 2023-04-17 17:22:39\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n import { InstallExtension } from '@/core/InstallExtension'\n@@ -12,11 +12,11 @@\n import { signCallback } from './SDK/asrauthentication'\n \n console.log('process', process)\n const config = {\n-  secretKey:process.env.secretKey,\n-  secretid: process.env.secretid,\n-  appid: process.env.appid,\n+  secretKey:process.env.SECRET_KEY,\n+  secretid: process.env.SECRET_ID,\n+  appid: process.env.APPID,\n   signCallback: signCallback, // 鉴权函数 用户提供鉴权函数，不传则为null\n   // 用户参数\n   // 实时识别接口参数\n   engine_model_type: '16k_zh', // 引擎\n"
                },
                {
                    "date": 1681723416734,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -12,9 +12,9 @@\n import { signCallback } from './SDK/asrauthentication'\n \n console.log('process', process)\n const config = {\n-  secretKey:process.env.SECRET_KEY,\n+  secretkey:process.env.SECRET_KEY,\n   secretid: process.env.SECRET_ID,\n   appid: process.env.APPID,\n   signCallback: signCallback, // 鉴权函数 用户提供鉴权函数，不传则为null\n   // 用户参数\n"
                },
                {
                    "date": 1681723930706,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 17:22:39\n+ * @LastEditTime: 2023-04-17 17:32:09\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n import { InstallExtension } from '@/core/InstallExtension'\n@@ -12,11 +12,11 @@\n import { signCallback } from './SDK/asrauthentication'\n \n console.log('process', process)\n const config = {\n-  secretkey:process.env.SECRET_KEY,\n-  secretid: process.env.SECRET_ID,\n-  appid: process.env.APPID,\n+  secretkey:process.env.NEXT_PUBLIC_SECRET_KEY,\n+  secretid: process.env.NEXT_PUBLIC_SECRET_ID,\n+  appid: process.env.NEXT_PUBLIC_APPID,\n   signCallback: signCallback, // 鉴权函数 用户提供鉴权函数，不传则为null\n   // 用户参数\n   // 实时识别接口参数\n   engine_model_type: '16k_zh', // 引擎\n"
                },
                {
                    "date": 1681724014807,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,18 +1,17 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 17:32:09\n+ * @LastEditTime: 2023-04-17 17:33:34\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n import { InstallExtension } from '@/core/InstallExtension'\n import webRecorder from './SDK/webRecorder'\n import SpeechRecognizer from './SDK/speechRecognizer'\n import { signCallback } from './SDK/asrauthentication'\n \n-console.log('process', process)\n const config = {\n   secretkey:process.env.NEXT_PUBLIC_SECRET_KEY,\n   secretid: process.env.NEXT_PUBLIC_SECRET_ID,\n   appid: process.env.NEXT_PUBLIC_APPID,\n"
                },
                {
                    "date": 1681727216379,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -74,19 +74,17 @@\n   }\n \n   private addListenerCallBack() {\n     this.speechRecognizer!.OnRecognitionStart = (res) => {\n-      console.log('开始识别', res);\n       this.isCanSendData = true;\n       this.isCanStop = true;\n     };\n     // @ts-ignore \n     this.speechRecognizer!.OnRecognitionResultChange = (res: any) => {\n       const currentText = `${this.resultText}${res.result.voice_text_str}`;\n       InstallExtension.emitter.emit('ResultChange', currentText)\n     };\n-    // @ts-ignore 一句话结束\n-    this.speechRecognizer!.OnSentenceEnd = (res: any) => {\n+    this.speechRecognizer!.OnSentenceEnd = (res: any): void => {\n       this.resultText += res.result.voice_text_str;\n       InstallExtension.emitter.emit('SentenceEnd', this.resultText)\n     };\n     // @ts-ignore 识别结束\n"
                },
                {
                    "date": 1681727245196,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -77,25 +77,26 @@\n     this.speechRecognizer!.OnRecognitionStart = (res) => {\n       this.isCanSendData = true;\n       this.isCanStop = true;\n     };\n-    // @ts-ignore \n-    this.speechRecognizer!.OnRecognitionResultChange = (res: any) => {\n+\n+    this.speechRecognizer!.OnRecognitionResultChange = (res) => {\n       const currentText = `${this.resultText}${res.result.voice_text_str}`;\n       InstallExtension.emitter.emit('ResultChange', currentText)\n     };\n-    this.speechRecognizer!.OnSentenceEnd = (res: any): void => {\n+    // 一句话结束\n+    this.speechRecognizer!.OnSentenceEnd = (res) => {\n       this.resultText += res.result.voice_text_str;\n       InstallExtension.emitter.emit('SentenceEnd', this.resultText)\n     };\n-    // @ts-ignore 识别结束\n-    this.speechRecognizer!.OnRecognitionComplete = (res: any) => {\n+    // 识别结束\n+    this.speechRecognizer!.OnRecognitionComplete = (res) => {\n       console.log('识别结束', res);\n       this.isCanSendData = false;\n       InstallExtension.emitter.emit('RecognitionComplete', res)\n     };\n-    // @ts-ignore 识别错误\n-    this.speechRecognizer!.OnError = (res: any) => {\n+    // 识别错误\n+    this.speechRecognizer!.OnError = (res) => {\n       console.log('识别失败', res);\n       this.isCanSendData = false;\n       InstallExtension.emitter.emit('Error', res)\n     };\n"
                },
                {
                    "date": 1681729914298,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,9 +1,9 @@\n /*\n  * @Author: Allen OYang\n  * @Email:  allenwill211@gmail.com\n  * @Date: 2023-04-17 10:36:51\n- * @LastEditTime: 2023-04-17 17:33:34\n+ * @LastEditTime: 2023-04-17 19:11:53\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n import { InstallExtension } from '@/core/InstallExtension'\n@@ -89,15 +89,13 @@\n       InstallExtension.emitter.emit('SentenceEnd', this.resultText)\n     };\n     // 识别结束\n     this.speechRecognizer!.OnRecognitionComplete = (res) => {\n-      console.log('识别结束', res);\n       this.isCanSendData = false;\n       InstallExtension.emitter.emit('RecognitionComplete', res)\n     };\n     // 识别错误\n     this.speechRecognizer!.OnError = (res) => {\n-      console.log('识别失败', res);\n       this.isCanSendData = false;\n       InstallExtension.emitter.emit('Error', res)\n     };\n \n"
                },
                {
                    "date": 1681729919914,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -38,11 +38,8 @@\n   private isCanStop: boolean = false;\n   private  resultText: string = ''\n \n \n-  constructor () {\n-  }\n-\n   public startRecord() {\n     this.recorder = new webRecorder()\n     const self = this\n     this.recorder.OnReceivedData = (res) => {\n"
                },
                {
                    "date": 1681742047710,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,9 +5,9 @@\n  * @LastEditTime: 2023-04-17 19:11:53\n  * @LastEditors: Allen OYang allenwill211@gmail.com\n  * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n  */\n-import { InstallExtension } from '@/core/InstallExtension'\n+import { InstallExtension } from '@/models/InstallExtension'\n import webRecorder from './SDK/webRecorder'\n import SpeechRecognizer from './SDK/speechRecognizer'\n import { signCallback } from './SDK/asrauthentication'\n \n"
                }
            ],
            "date": 1681712555157,
            "name": "Commit-0",
            "content": "/*\n * @Author: Allen OYang\n * @Email:  allenwill211@gmail.com\n * @Date: 2023-04-17 10:36:51\n * @LastEditTime: 2023-04-17 14:22:34\n * @LastEditors: Allen OYang allenwill211@gmail.com\n * @FilePath: /speak-gpt/src/extensions/TencetcloudRecord/index.ts\n */\n\nimport webRecorder from './SDK/webRecorder'\nimport SpeechRecognizer from './SDK/speechRecognizer'\nimport { signCallback } from './SDK/asrauthentication'\n\nconst config = {\n  secretKey: 'Ndpvv6EJMKBuYfjjdt25972xqhVCoJnF',\n  secretid: 'AKIDLeHoDXmuvrjUehfYK2gCf5QfpvtkVAh7',\n  appid: 1256214321,\n  signCallback: signCallback, // 鉴权函数 用户提供鉴权函数，不传则为null\n  // 用户参数\n  // 实时识别接口参数\n  engine_model_type: '16k_zh', // 引擎\n  voice_format: 1,\n  // 以下为非必填参数，可跟据业务自行修改\n  hotword_id: '08003a00000000000000000000000000',\n  needvad: 1,\n  filter_dirty: 1,\n  filter_modal: 1,\n  filter_punc: 1,\n  convert_num_mode: 1,\n  word_info: 2\n}\n\n\nexport class TencetCloudRecord {\n  private recorder: webRecorder | null = null;\n  private speechRecognizer: SpeechRecognizer | null = null;\n  private isCanSendData: boolean = false;\n  private isCanStop: boolean = false;\n  constructor () {\n\n  }\n\n  startRecord() {\n    this.recorder = new webRecorder()\n    const self = this\n    this.recorder.OnReceivedData = (res) => {\n      console.log(res) // res 为采集到浏览器数据\n      if (self.isCanSendData) {\n        // 发送数据\n        self.speechRecognizer!.write(res);\n      }\n    };\n    // 录音失败时\n    this.recorder.OnError = (err) => {\n      this.recorder!.stop();\n    };\n    this.recorder.start();\n\n    if (!this.speechRecognizer) {\n      this.speechRecognizer = new SpeechRecognizer(config);\n      this.addListenerCallBack()\n      \n      // 建立连接\n      this.speechRecognizer!.start();\n    }\n  }\n\n  stopRecord() {\n    if (this.isCanStop) {\n      this.speechRecognizer!.stop();\n    }\n  }\n\n  private addListenerCallBack() {\n    this.speechRecognizer!.OnRecognitionStart = (res) => {\n      console.log('开始识别', res);\n      this.isCanSendData = true;\n      this.isCanStop = true;\n    };\n  \n    this.speechRecognizer!.OnRecognitionResultChange = (res: any) => {\n      console.log('识别变化时', res);\n    };\n    // 一句话结束\n    this.speechRecognizer!.OnSentenceEnd = (res: any) => {\n      console.log('一句话结束', res);\n    };\n    // 识别结束\n    this.speechRecognizer!.OnRecognitionComplete = (res: any) => {\n      console.log('识别结束', res);\n      this.isCanSendData = false;\n    };\n    // 识别错误\n    this.speechRecognizer!.OnError = (res: any) => {\n      console.log('识别失败', res);\n      this.isCanSendData = false;\n    };\n\n  }\n\n  static extensionName = 'TencetCloudRecord'\n}"
        }
    ]
}